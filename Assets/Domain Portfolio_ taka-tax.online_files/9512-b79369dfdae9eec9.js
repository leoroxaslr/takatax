"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9512],{39512:function(e,s,t){t.r(s),t.d(s,{default:function(){return Ze}});var a=t(85893),n=t(11780),o=t(83899),i=t(14416),d=t(47568),r=t(26042),l=t(69396),c=t(99534),u=t(36305),m=t(70655),f=t(32117),N=t.n(f),h=t(24894),g=t.n(h),p=t(97989),v=t.n(p),x=t(95620),H=t(25640),j=t(78224),A=t.n(j),b=t(40189),I=t.n(b),y=t(90254),R=t.n(y),D=t(52269),E=t(56381),C=t.n(E),S=t(78722),T=t.n(S),_=t(92930),k=t(67331),Z=t(93208);function M(e){var s,t=e.onDeleteSuccess,n=e.onClose,i=e.hostName,c=e.domainName,u=e.deleteHostName,f=e.dataToLog,h=function(){j||n()};(0,o.useEffect)((function(){_.Z.logAnalyticsEvent(k.z.dns_hostnames_delete_modal,f)}),[]);var p=(0,o.useState)(!1),j=p[0],b=p[1],I=(0,o.useState)(null),y=I[0],E=I[1],C=(0,Z.i)(null===D.aT||void 0===D.aT||null===(s=D.aT.supportContacts)||void 0===s?void 0:s.technicalSupportPhone)||"",S=(0,H.useIntl)();function M(){return M=(0,d.Z)((function(){var e,s;return(0,m.__generator)(this,(function(a){switch(a.label){case 0:return b(!0),j?[2]:(_.Z.logAnalyticsEvent(k.z.dns_hostnames_delete_modal_submit,f),E(null),[4,u({hostName:i.host,domainName:c})]);case 1:return e=a.sent(),b(!1),e.error?(_.Z.logAnalyticsEvent(k.z.dns_hostnames_delete_modal_error,(0,l.Z)((0,r.Z)({},f),{code:null===e||void 0===e||null===(s=e.payload)||void 0===s?void 0:s.code})),[2,E(e.payload)]):(_.Z.logAnalyticsEvent(k.z.dns_hostnames_delete_modal_success,f),t(i),n(),[2])}}))})),M.apply(this,arguments)}return(0,a.jsxs)(g(),{className:"ux-modal-width ux-modal-max-width",title:(0,a.jsx)(T().h1,{as:"title",text:S.formatMessage({id:"dnsHostNamesDeleteTitle"})}),id:"deleteHostNamesModal",onClose:h,"data-testid":"HostNameDeleteModal",children:[Boolean(y)&&(0,a.jsx)(R(),{id:"deleteModalAlert",className:"mt-4",emphasis:"critical",onClose:function(){return E(null)},title:(0,a.jsx)(T().p,{text:S.formatMessage({id:"dnsHostNamesDeleteError"},{supportNumber:C})})}),(0,a.jsx)(T().p,{className:"my-4",text:S.formatMessage({id:"dnsHostNamesDeleteMessage"},{domainName:c})}),(0,a.jsxs)(x.default,{gap:"md",children:[(0,a.jsx)(N(),{"data-testid":"HostNameDeleteModal.delete",design:"primary",text:S.formatMessage({id:"Delete"}),disabled:j,icon:j&&(0,a.jsx)(v(),{size:"sm"})||null,"data-eid":A().formatEid("HostNameDeleteModal","confirmDelete","click"),onClick:function(){return M.apply(this,arguments)}}),(0,a.jsx)(N(),{"data-testid":"HostNameDeleteModal.cancel",text:S.formatMessage({id:"cancel"}),disabled:j,"data-eid":A().formatEid("HostNameDeleteModal","cancelDelete","click"),onClick:h})]})]})}M.propTypes={onDeleteSuccess:I().func.isRequired,onClose:I().func.isRequired,hostNames:I().array.isRequired,domainName:I().string.isRequired,deleteHostName:I().func.isRequired,dataToLog:I().object.isRequired};var q={deleteHostName:C().actionCreators.deleteHostName},F=(0,i.connect)((function(){}),q)(M),L=t(14924),w=t(65366),P=t(57632);function W(e){var s,t={};e.host?(s=e.host,/^[a-zA-Z0-9\-.\s]+$/.test(s)||(t.host={code:"InvalidCharacter"})):t.host={code:"Required"};var a={};e.ipAddresses.forEach((function(e){var s=e.value;a[s]||(a[s]=0),a[s]++}));var n=e.ipAddresses.map((function(e){var s=e.value;return s?a[s]>1?{code:"DuplicateIpAddress"}:null:{code:"Required"}}));return n.find((function(e){return null!==e}))&&(t.ipAddresses=n),Object.keys(t).length>0?{fieldErrors:t}:null}var O="IPAddress";function G(e,s){!function(e,s){"VALIDATION_ERROR"===e.code&&(e.code="VerificationError");var t=e.message;e.fields||(e.fields=[]);var a="Invalid IP: ";if(null===t||void 0===t?void 0:t.startsWith(a)){var n=e.message.split(a)[1],o=s.hostIPs.findIndex((function(e){return e===n}));e.fields.push({path:"".concat(O).concat(o)})}}(e,s);var t={};if(e.fields){var a=!0,n=!1,o=void 0;try{for(var i,d=e.fields[Symbol.iterator]();!(a=(i=d.next()).done);a=!0){var r=i.value;if(r.path.includes(O)){var l=parseInt(r.path.slice(O.length),10);for(t.ipAddresses||(t.ipAddresses=[]);l>=t.ipAddresses.length;)t.ipAddresses.push(null);t.ipAddresses[l]=r}else["Host","HostName"].includes(r.path)&&(t.host=r)}}catch(c){n=!0,o=c}finally{try{a||null==d.return||d.return()}finally{if(n)throw o}}}e.fieldErrors=t}var z={ACTIVE:"active",ADDING:"adding",REMOVING:"removing",ERROR:"error",UPDATING:"updating",NONE:"none"},V=[5,10,20],U="DOMAIN_IN_HOST",K="EDIT_WARNING";function Q(e){var s=e.onSave,t=e.onClose,n=e.formData,o=(0,H.useIntl)().formatMessage;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T().p,{text:o({id:"dnsHostNameFormWarningHostUpdate"})}),(0,a.jsxs)(x.default,{gap:"md",children:[(0,a.jsx)(N(),{design:"primary","data-testid":"HostNameEditWarning.save",id:"dnsHostNamesFormWarningSave",text:o({id:"Save"}),"data-eid":A().formatEid("dns","HostNameEditWarningSave","click"),onClick:function(){return s(n)}}),(0,a.jsx)(N(),{id:"dnsHostNamesFormWarningCancel",text:o({id:"cancel"}),"data-eid":A().formatEid("dns","HostNameEditWarningCancel","click"),onClick:t})]})]})}Q.propTypes={onSave:I().func,onClose:I().func,formData:I().object};var B,X=t(20049);function Y(e){var s=e.onSave,t=e.onClose,n=e.domainName,i=e.formData,d=(0,H.useIntl)().formatMessage,l=(0,o.useState)(!1),c=l[0],u=l[1],m={b:function(e){return(0,a.jsx)("strong",{children:e})},domainName:n,host:null===i||void 0===i?void 0:i.host},f=[{label:d({id:"confirmARecordChange"},m),name:"applyOption",value:"change",checked:!c,onChange:function(){u(!1)}},{label:d({id:"confirmARecordKeep"},m),name:"keepOption",value:"keep",checked:c,onChange:function(){u(!0)}}];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T().p,{text:d({id:"dnsHostNamesFormWarningDomainInHost"},m)}),(0,a.jsx)(T().p,{text:d({id:"dnsHostNamesFormWarningDomainInHostQuestion"},m)}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(x.default,{orientation:"vertical",gap:"sm",children:f.map((function(e){return(0,a.jsx)(X.Z,{id:e.name,label:e.label,name:e.name,value:e.value,checked:e.checked,onChange:e.onChange},e.name)}))})}),(0,a.jsxs)(x.default,{gap:"md",children:[(0,a.jsx)(N(),{design:"primary",id:"dnsHostNamesFormWarningSave",text:d({id:"Save"}),"data-eid":A().formatEid("dns","HostNameDomainInHostWarningSave","click"),onClick:function(){var e=(0,r.Z)({},i);!1===c&&"string"===typeof e.host&&(e.host.toLowerCase()===n.toLowerCase()?e.host="":e.host=e.host.replace(".".concat(n),"")),s(e)}}),(0,a.jsx)(N(),{id:"dnsHostNamesFormWarningCancel",text:d({id:"cancel"}),"data-eid":A().formatEid("dns","HostNameDomainInHostWarningCancel","click"),onClick:t})]})]})}Y.propTypes={onSave:I().func,onClose:I().func,domainName:I().string,formData:I().object},J.propTypes={onSave:I().func,onClose:I().func,domainName:I().string,formData:I().object,warning:I().string.isRequired};var $=(B={},(0,L.Z)(B,U,Y),(0,L.Z)(B,K,Q),B);function J(e){var s=e.onSave,t=e.onClose,n=e.domainName,o=e.formData,i=e.warning,d=(0,H.useIntl)().formatMessage,r=$[i];return(0,a.jsx)(g(),{title:(0,a.jsx)(T().h1,{as:"title",text:d({id:"dnsHostNamesFormWarningTitle"})}),id:"dnsHostNamesFormWarningModal",onClose:t,"data-testid":"HostNameFormWarningModal",children:(0,a.jsx)(r,{onSave:s,onClose:t,domainName:n,formData:o})})}var ee=t(87501),se=t.n(ee),te=t(28825),ae=t(77273),ne=t(58777),oe=t(25469),ie=t.n(oe);function de(e){var s=e.ipAddresses,t=e.error,n=e.isSubmitting,o=e.hostNameRules,i=e.onChange,d=e.eids,c=function(e){var t=e.keyId;return function(){f&&i(s.filter((function(e){return e.keyId!==t})))}},m=(0,ae.useIntl)(),f=(null===o||void 0===o?void 0:o.minIP)<(null===s||void 0===s?void 0:s.length),h=(null===o||void 0===o?void 0:o.maxIP)>(null===s||void 0===s?void 0:s.length);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(te.default,{required:!0,htmlFor:"ipAddressIpInput-0",children:m.formatMessage({id:"dnsHostNamesIpAddresses",source:"Dns.dnsHostNamesIpAddresses.label"})}),s.map((function(e,o){var u,h,g=null===t||void 0===t||null===(u=t.ipAddresses)||void 0===u?void 0:u[o],p="ipAddressIpInput-"+o,v=(h={label:"",invalid:!!g,id:p,disabled:n,className:"flex-grow-1"},(0,L.Z)(h,"aria-label",m.formatMessage({id:"dnsHostNamesIpAddress",source:"Dns.dnsHostNamesIpAddress.textinput"},{number:o+1})),(0,L.Z)(h,"value",e.value),(0,L.Z)(h,"onChange",function(e){var t=e.keyId;return function(e){var a=s.map((function(s){return s.keyId===t&&(s.value=e),s}));i(a)}}(e)),h);return(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("div",{className:"d-flex align-items-center",children:f?(0,a.jsx)(ne.Z,(0,l.Z)((0,r.Z)({},v),{button:(0,a.jsx)(N(),{disabled:n,onClick:c(e),icon:(0,a.jsx)(se(),{}),"data-eid":d.removeIpAdress,"aria-label":m.formatMessage({id:"dnsHostNamesDeleteIpAddress",source:"Dns.dnsHostNamesDeleteIpAddress"},{number:o+1})})})):(0,a.jsx)(w.default,(0,r.Z)({},v))}),g&&(0,a.jsx)(T().small,{htmlFor:p,emphasis:"critical",className:"ux-text-caption",text:(0,a.jsx)(ae.FormattedMessage,{id:"dnsHostNamesIpInputError".concat((null===g||void 0===g?void 0:g.code)||"Default"),defaultMessageId:"dnsHostNamesIpInputErrorDefault",source:"Dns.HostNameFormIpAddressesInput.inputError"})})]},e.keyId)})),(0,a.jsx)(N(),{design:"inline",icon:(0,a.jsx)(ie(),{}),disabled:!h||n,onClick:function(){i((0,u.Z)(s).concat([{value:"",keyId:(0,P.Z)()}]))},className:"text-nowrap d-none d-md-inline-block add-ip-button",text:m.formatMessage({id:"dnsRecordAddAnotherValue"},{underline:function(e){return(0,a.jsx)("u",{children:e})}})})]})}function re(e){var s,t,n,i,c=e.domainName,u=e.hostName,f=e.onClose,h=e.hostNameRules,g=e.onSuccess,p=e.updateHostName,H=e.addHostName,j=e.className,b=e.dataToLog,I=function(e,s){var t=(0,l.Z)((0,r.Z)({},s),(0,L.Z)({},e,!1));return ee(t),t},y=!u;(0,o.useEffect)((function(){_.Z.logAnalyticsEvent(y?k.z.dns_hostnames_add_form:k.z.dns_hostnames_edit_form,b)}),[]);var E=(0,Z.i)(null===D.aT||void 0===D.aT||null===(s=D.aT.supportContacts)||void 0===s?void 0:s.technicalSupportPhone),C=(0,o.useState)(function(e,s){var t={host:"",ipAddresses:[]};s&&((t=(0,r.Z)({},s)).ipAddresses=t.hostIPs.map((function(e){return{value:e,keyId:(0,P.Z)()}})),delete t.hostIPs);for(var a=e.minIP-t.ipAddresses.length;a>0;)t.ipAddresses.push({value:"",keyId:(0,P.Z)()}),a--;return t}(h,u)),S=C[0],M=C[1],q=(0,o.useState)(!1),F=q[0],O=q[1],V=(0,o.useState)(null),Q=V[0],B=V[1],X=(0,ae.useIntl)(),Y=(0,o.useState)({}),$=Y[0],ee=Y[1];function se(e){return te.apply(this,arguments)}function te(){return te=(0,d.Z)((function(e){var s,t,a,n,o,i,d,N,h=arguments;return(0,m.__generator)(this,(function(m){switch(m.label){case 0:return s=h.length>1&&void 0!==h[1]?h[1]:S,t=h.length>2&&void 0!==h[2]?h[2]:$,e&&e.preventDefault(),(a=W(s))?[2,B(a)]:!t[U]&&S.host.toLowerCase().endsWith(c.toLowerCase())?[2,I(U,t)]:t[K]||y?(_.Z.logAnalyticsEvent(y?k.z.dns_hostnames_add_form_submit:k.z.dns_hostnames_edit_form_submit,b),O(!0),n={host:s.host,hostIPs:s.ipAddresses.map((function(e){return e.value}))},y?[4,H({domainName:c},{body:n})]:[3,2]):[2,I(K,t)];case 1:return i=m.sent(),[3,4];case 2:return[4,p({domainName:c,hostName:u.host},{body:n})];case 3:i=m.sent(),m.label=4;case 4:return(o=i).error||o.payload.errors?(_.Z.logAnalyticsEvent(y?k.z.dns_hostnames_add_form_error:k.z.dns_hostnames_edit_form_error,(0,l.Z)((0,r.Z)({},b),{code:null===o||void 0===o||null===(d=o.payload)||void 0===d?void 0:d.code})),O(!1),G(N=o.error?o.payload:o.payload.errors,n),[2,B(N)]):(_.Z.logAnalyticsEvent(y?k.z.dns_hostnames_add_form_success:k.z.dns_hostnames_edit_form_success,b),n.status=y?z.ADDING:z.UPDATING,g(n,u),f(),[2])}}))})),te.apply(this,arguments)}var ne,oe=(ne=!!u,{submit:A().formatEid("HostNameForm","".concat(ne?"edit":"add","Submit"),"click"),cancel:A().formatEid("HostNameForm","".concat(ne?"edit":"add","Cancel"),"click"),removeIpAddress:A().formatEid("HostNameForm","removeIpAddress","click"),addIpAddress:A().formatEid("HostNameForm","addIpAddress","click")}),ie=Object.keys($).find((function(e){return!1===$[e]}));return(0,a.jsxs)(a.Fragment,{children:[ie&&(0,a.jsx)(J,{onSave:function(e){return function(e,s){var t=(0,l.Z)((0,r.Z)({},$),(0,L.Z)({},e,!0));ee(t),s&&M(s),se(null,s,t)}(ie,e)},onClose:function(){return function(e){var s=(0,r.Z)({},$);e in s&&delete s[e],ee(s)}(ie)},domainName:c,formData:S,warning:ie}),(0,a.jsxs)("form",{"data-testid":"HostNameForm",onSubmit:se,className:j||"p-3 bg-medium",children:[(0,a.jsxs)("div",{className:"row",children:[(0,a.jsx)("fieldset",{className:"col-12 col-md-6",children:(0,a.jsx)(w.default,{"data-testid":"HostNameForm.TextInput.host",invalid:!!(null===Q||void 0===Q||null===(t=Q.fieldErrors)||void 0===t?void 0:t.host),errorMessage:(null===Q||void 0===Q||null===(n=Q.fieldErrors)||void 0===n?void 0:n.host)?(0,a.jsx)(ae.FormattedMessage,{id:"dnsHostNamesHostInputError".concat((null===Q||void 0===Q||null===(i=Q.fieldErrors)||void 0===i?void 0:i.host.code)||"Default"),defaultMessageId:"dnsHostNamesHostInputErrorDefault",source:"Dns.HostNameForm"}):null,required:!0,disabled:!y&&!h.hostNameChangeAllowed||F,className:"mb-3",id:"hostInput",label:X.formatMessage({id:"dnsHostNamesHost",source:"Dns.HostNameForm.label"}),value:S.host,onChange:function(e){M((0,l.Z)((0,r.Z)({},S),{host:e}))}})}),(0,a.jsx)("fieldset",{className:"col-12 col-md-6",children:(0,a.jsx)(de,{ipAddresses:S.ipAddresses,error:null===Q||void 0===Q?void 0:Q.fieldErrors,isSubmitting:F,hostNameRules:h,onChange:function(e){M((0,l.Z)((0,r.Z)({},S),{ipAddresses:e}))},eids:oe})})]}),!!(null===Q||void 0===Q?void 0:Q.code)&&(0,a.jsx)(R(),{className:"mb-4",emphasis:"critical",id:"submitErrorAlert",title:(0,a.jsx)(T().p,{text:X.formatMessage({id:"dnsHostNamesFormError"+(null===Q||void 0===Q?void 0:Q.code),defaultMessage:X.formatMessage({id:"GenericErrorMessage"},{supportPhone:E,custom:function(e){return e}}),source:"Dns.HostNameForm.submitErrorAlert"})})}),(0,a.jsxs)(x.default,{gap:"md",className:"hostname-form-action-buttons",children:[(0,a.jsx)(N(),{type:"submit",design:"primary",text:X.formatMessage({id:"Save",source:"Dns.HostNameForm.Save"}),disabled:F,icon:F&&(0,a.jsx)(v(),{size:"sm"})||null,"data-eid":oe.submit}),(0,a.jsx)(N(),{type:"button",design:"secondary",text:X.formatMessage({id:"cancel",source:"Dns.HostNameForm.cancel"}),disabled:F,"data-eid":oe.cancel,onClick:function(){F||f()}})]})]})]})}de.propTypes={ipAddresses:I().array.isRequired,error:I().object,isSubmitting:I().bool,hostNameRules:I().object.isRequired,onChange:I().func.isRequired,eids:I().object.isRequired},re.propTypes={domainName:I().string.isRequired,hostName:I().object,hostNameRules:I().object.isRequired,onClose:I().func.isRequired,onSuccess:I().func.isRequired,updateHostName:I().func.isRequired,addHostName:I().func.isRequired,className:I().string,dataToLog:I().object.isRequired};var le={updateHostName:C().actionCreators.updateHostName,addHostName:C().actionCreators.addHostName},ce=(0,i.connect)((function(e,s){var t=s.domainName,a=(0,n.pD)("dccApi","getHostNameRules",e,{domainName:t}).value;return{hostRules:Object.keys(a||{}).length>0?a:null}}),le)(re),ue=t(6),me=t.n(ue),fe=t(38010),Ne=t.n(fe);function he(e){var s=e.hostName,t=e.onDelete,n=e.onEdit,o=e.isEditing,i=e.domainName,d=e.onEditSuccess,c=e.onEditClose,u=e.hostNameRules,m=e.isAllActionsDisabled,f=e.dataToLog,h=s.host,g=s.hostIPs,p=s.status,x=(0,H.useIntl)();if(o)return(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,style:{padding:0},children:(0,a.jsx)(ce,{onSuccess:d,domainName:i,hostName:s,onClose:c,hostNameRules:u,dataToLog:f})})});var j={disabled:p!==z.ACTIVE||m};return(0,a.jsxs)("tr",{"data-testid":"HostNameRow",children:[(0,a.jsx)("td",{width:"19%",children:(0,a.jsxs)("div",{className:"data-cell",children:[h," "]})}),(0,a.jsx)("td",{width:"80%",children:(0,a.jsx)("div",{className:"data-cell",children:g.join(", ")})}),p===z.ADDING?(0,a.jsx)("td",{colSpan:2,align:"center",children:(0,a.jsx)(v(),{})}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:"d-flex",children:[(0,a.jsx)(N(),(0,l.Z)((0,r.Z)({},j),{icon:p===z.REMOVING?(0,a.jsx)(v(),{}):(0,a.jsx)(se(),{}),onClick:t,"aria-label":x.formatMessage({id:"Delete"}),"data-eid":A().formatEid("HostNameRow","startDelete","click"),"data-testid":"HostNameRow.delete"})),(0,a.jsx)(N(),(0,l.Z)((0,r.Z)({},j),{icon:p===z.UPDATING?(0,a.jsx)(v(),{}):(0,a.jsx)(Ne(),{}),onClick:function(){return n(h)},"aria-label":x.formatMessage({id:"Edit"}),"data-eid":A().formatEid("HostNameRow","startEdit","click"),"data-testid":"HostNameRow.edit"}))]})})})]})}he.propTypes={hostName:I().object.isRequired,hostNameRules:I().object.isRequired,onDelete:I().func.isRequired,onEdit:I().func.isRequired,isEditing:I().bool.isRequired,domainName:I().string.isRequired,onEditSuccess:I().func.isRequired,onEditClose:I().func.isRequired,isAllActionsDisabled:I().bool,dataToLog:I().object.isRequired};var ge=t(29087),pe=t.n(ge);function ve(e){var s=e.domainName,t=e.hostNames,n=e.setHostNameDeleting,i=e.setHostNameEditingKeyId,d=e.onEditSuccess,r=e.hostNameEditingKeyId,l=e.hostNameRules,c=e.isAllActionsDisabled,u=e.dataToLog,m=(0,H.useIntl)(),f=(0,o.useState)(1),N=f[0],h=f[1],g=(0,o.useState)(V[0]),p=g[0],v=g[1],x=t.length>V[0],j=(0,o.useMemo)((function(){var e=t.slice((N-1)*p,(N-1)*p+p);return 0===e.length&&N>1&&h(1),e}),[t,N,p]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{"data-testid":"HostNameTable",className:"table-container",children:(0,a.jsxs)(me(),{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{column:m.formatMessage({id:"dnsHostNamesHost"}),children:m.formatMessage({id:"dnsHostNamesHost"})}),(0,a.jsx)("th",{column:m.formatMessage({id:"dnsHostNamesIpAddresses"}),children:m.formatMessage({id:"dnsHostNamesIpAddresses"})}),(0,a.jsx)("th",{"aria-label":m.formatMessage({id:"Actions"})})]})}),(0,a.jsx)("tbody",{children:j.map((function(e){return(0,a.jsx)(he,{domainName:s,hostName:e,onDelete:function(){return n(e)},onEdit:function(){return i(e.keyId)},onEditClose:function(){return i(null)},onEditSuccess:d,isEditing:r===e.keyId,hostNameRules:l,isAllActionsDisabled:c,dataToLog:u},e.host)}))})]})}),x&&(0,a.jsx)(pe(),{id:"hostNamesPagination",defaultSelected:N,pageItems:p,pageItemsChoices:V,totalItems:t.length,onChange:function(e,s){h(e),v(s)}})]})}ve.propTypes={domainName:I().string.isRequired,hostNames:I().array.isRequired,hostNameRules:I().object.isRequired,setHostNameDeleting:I().func.isRequired,setHostNameEditingKeyId:I().func.isRequired,onEditSuccess:I().func.isRequired,hostNameEditingKeyId:I().string,isAllActionsDisabled:I().bool,dataToLog:I().object.isRequired};var xe=t(82271),He=t(88788),je=t(37157),Ae=t(95033);function be(){var e=(0,ae.useIntl)().formatMessage;return(0,a.jsx)(T().p,{emphasis:"passive",className:"mb-4 description dns-description-text",text:e({id:"dnsHostNamesExplanation"},{action:function(e){return(0,a.jsx)(He.Z,{text:e[0],url:je.DNS_TABS.HOSTNAMES.helpLink,eid:Ae.Z.DnsPage.Hostnames.HostNamesHelpLink})}})})}function Ie(e){var s=e.onAddHost,t=e.isAddingHostName,n=e.onSuccessAddHostName,o=e.domainName,i=e.onCloseAddHost,d=e.hostNameRules,r=e.isAllActionsDisabled,l=e.dataToLog,c=(0,ae.useIntl)().formatMessage;return t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(be,{}),(0,a.jsx)(ce,{className:"no-content-form",onSuccess:n,domainName:o,onClose:i,hostNameRules:d,dataToLog:l})]}):(0,a.jsxs)("div",{"data-testid":"NoHostNamesContent",className:"d-flex flex-column align-items-center no-hostnames-content",children:[(0,a.jsx)(xe.Z,{}),(0,a.jsx)(be,{}),(0,a.jsx)(N(),{disabled:d.maxHosts<=0||r,"data-eid":A().formatEid("noHostNamesContent","startAdd","click"),design:"primary",className:"add-button",onClick:s,text:c({id:"dnsHostNamesAddHostName",source:"Dns.NoHostNamesContent.AddHostName"})})]})}function ye(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(s){setTimeout(s,e)}))}function Re(e){var s=function(e){q({domainName:i,hostName:e},{isMatch:function(e){return e.status===z.ACTIVE},onMatch:function(s){y((function(t){return t.map((function(t){return t.keyId===e.keyId?(0,r.Z)({},t,s):t}))}))}})},t=function(e){q({domainName:i,hostName:e},{isMatch:function(e){return"HOST_NOT_FOUND"===e.code},onMatch:function(){y((function(s){return s.filter((function(s){var t=s.keyId;return e.keyId!==t}))}))}})},n=function(e){var t=(0,l.Z)((0,r.Z)({},e),{keyId:(0,P.Z)()});y((function(e){return(0,u.Z)(e).concat([t])})),s(t),C(!1)},i=e.domainName,f=e.getHostName,h=e.hostNameRules,g=e.pollingWaitTime,p=void 0===g?5e3:g,v=e.isAllActionsDisabled,x=e.dataToLog,j=(0,c.Z)(e,["domainName","getHostName","hostNameRules","pollingWaitTime","isAllActionsDisabled","dataToLog"]),b=(0,o.useState)([]),I=b[0],y=b[1],R=(0,H.useIntl)().formatMessage,D=(0,o.useState)(!1),E=D[0],C=D[1],S=(0,o.useState)(null),T=S[0],_=S[1],k=(0,o.useState)(null),Z=k[0],M=k[1];function q(e,s){return L.apply(this,arguments)}function L(){return(L=(0,d.Z)((function(e,s){var t,a,n,o,i,d,r,l;return(0,m.__generator)(this,(function(c){switch(c.label){case 0:t=e.domainName,a=e.hostName,n=s.onMatch,o=s.isMatch,i=50,d=0,c.label=1;case 1:return d<=i?[4,ye(p)]:[3,5];case 2:return c.sent(),[4,f({domainName:t,hostName:a.host})];case 3:if(r=c.sent(),l=null===r||void 0===r?void 0:r.payload,!!l&&o(l))return[2,n(l)];c.label=4;case 4:return d++,[3,1];case 5:return[2]}}))}))).apply(this,arguments)}return(0,o.useEffect)((function(){var e=j.hostNames.map((function(e){return(0,l.Z)((0,r.Z)({},e),{keyId:(0,P.Z)()})}));y(e);var a=!0,n=!1,o=void 0;try{for(var i,d=e[Symbol.iterator]();!(a=(i=d.next()).done);a=!0){var c=i.value;[z.ADDING,z.UPDATING].includes(c.status)?s(c):z.REMOVING===c.status&&t(c)}}catch(u){n=!0,o=u}finally{try{a||null==d.return||d.return()}finally{if(n)throw o}}}),[i]),0===I.length?(0,a.jsx)(Ie,{onSuccessAddHostName:n,domainName:i,isAddingHostName:E,onCloseAddHost:function(){return C(!1)},onAddHost:function(){return C(!0)},hostNameRules:h,isAllActionsDisabled:v,dataToLog:x}):(0,a.jsxs)(a.Fragment,{children:[Z&&(0,a.jsx)(F,{domainName:i,hostName:Z,onDeleteSuccess:function(e){y((function(s){return s.map((function(s){return e.keyId===s.keyId&&(s.status=z.REMOVING),s}))})),t(e)},onClose:function(){return M(null)},dataToLog:x}),(0,a.jsx)(be,{}),(0,a.jsx)("div",{className:"action-bar d-flex justify-content-start bg-medium p-3 mb-3",children:(0,a.jsx)(N(),{disabled:h.maxHosts<=I.length||v,text:R({id:"add"}),design:"primary",onClick:function(){return C(!0)},"data-eid":A().formatEid("HostNameContent","startAdd","click"),"data-testid":"HostNameContent.add"})}),E&&(0,a.jsx)(ce,{dataToLog:x,hostNameRules:h,onSuccess:n,domainName:i,onClose:function(){return C(!1)}}),(0,a.jsx)(ve,{domainName:i,hostNameRules:h,hostNames:I,setHostNameDeleting:M,setHostNameEditingKeyId:_,onEditSuccess:function(e,t){var a=t.keyId,n=(0,l.Z)((0,r.Z)({},e),{keyId:a});y((function(e){return e.map((function(e){return e.keyId===a?n:e}))})),s(n),_(null)},hostNameEditingKeyId:T,isAllActionsDisabled:v,dataToLog:x})]})}Ie.propTypes={onAddHost:I().func,isAddingHostName:I().bool.isRequired,onSuccessAddHostName:I().func,domainName:I().string.isRequired,onCloseAddHost:I().func,hostNameRules:I().object,isAllActionsDisabled:I().bool,dataToLog:I().object.isRequired},Re.propTypes={domainName:I().string.isRequired,getHostName:I().func.isRequired,hostNames:I().array.isRequired,pollingWaitTime:I().number,isAllActionsDisabled:I().bool,dataToLog:I().object.isRequired};var De={getHostName:C().actionCreators.getHostName},Ee=(0,i.connect)((function(){return{}}),De)(Re),Ce=t(67430),Se=t(92683),Te=function(e){if(!e)return"eligibilityreason.".concat(e,".notDefined");var s="".concat(e).toUpperCase(),t=Se.X[s];return t||"eligibilityreason.".concat(e,".noDefinedId")};function _e(e){var s,t=e.domainName,n=e.getHostNames,i=e.getHostNameRules,d=e.getHostNamesReset,r=e.hostNames,l=e.hostNameRules,c=e.displayStatus,u=e.isAllActionsDisabled,m=e.eligibilityReasons,f=e.dataToLog,N=void 0===f?{}:f,h=(0,Z.i)(null===D.aT||void 0===D.aT||null===(s=D.aT.supportContacts)||void 0===s?void 0:s.technicalSupportPhone)||"";return(0,o.useEffect)((function(){t&&c===Ce.l.AWAITING_FETCH_REQUEST&&(n({domainName:t}),i({domainName:t}))}),[t,c]),(0,o.useEffect)((function(){return function(){return d({domainName:t})}}),[t]),[Ce.l.LOADING,Ce.l.AWAITING_FETCH_REQUEST].includes(c)?(0,a.jsx)("div",{className:"d-flex justify-content-center",children:(0,a.jsx)(v(),{size:"lg"})}):(0,a.jsxs)(a.Fragment,{children:[c===Ce.l.ERROR&&(0,a.jsx)(R(),{className:"mb-4",emphasis:"critical",title:(0,a.jsx)(ae.FormattedMessage,{id:"dccErrorMsgContent",values:{supportPhone:h}})}),u&&(0,a.jsx)(R(),{className:"mb-4",emphasis:"info",title:(0,a.jsx)(ae.FormattedMessage,{id:Te(null===m||void 0===m?void 0:m[0]),values:{supportPhone:h},source:"Dns.HostNames"})}),c===Ce.l.DISPLAYED&&(0,a.jsx)(Ee,{dataToLog:N,domainName:t,hostNames:r,hostNameRules:l,isAllActionsDisabled:u})]})}_e.propTypes={domainName:I().string.isRequired,getHostNames:I().func.isRequired,getHostNameRules:I().func.isRequired,hostNames:I().array,hostNameRules:I().object,status:I().string,eligibilityReason:I().string,getHostNamesReset:I().func,displayStatus:I().string,isAllActionsDisabled:I().bool,dataToLog:I().object};var ke={getHostNames:C().actionCreators.getHostNames,getHostNameRules:C().actionCreators.getHostNameRules,getHostNamesReset:C().actionCreators.getHostNames.reset},Ze=(0,i.connect)((function(e,s){var t=s.domainName,a=(0,n.pD)("domainDnsApi","getHostNames",e,{domainName:t}).value,o=(0,n.pD)("domainDnsApi","getHostNameRules",e,{domainName:t}).value,i=(0,Ce.c)(e,t),d=i.displayStatus,r=i.eligibilityReasons;return{isAllActionsDisabled:i.isDisabled,displayStatus:d,eligibilityReasons:r,hostNames:Array.isArray(a)?a:[],hostNameRules:Object.keys(o||{}).length>0?o:{}}}),ke)(_e)}}]);